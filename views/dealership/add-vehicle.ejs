<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= title %></title>
  <link rel="stylesheet" href="/css/main.css">
</head>
<body>
  <%- include('../partials/header') %>
  
  <div class="container">
    <h1><%= title %></h1>
    
    <% if (error) { %>
      <div class="alert alert-error"><%= error %></div>
    <% } %>
    
    <% if (success) { %>
      <div class="alert alert-success"><%= success %></div>
    <% } %>
    
    <div class="card">
      <form method="POST" action="/dealership/add-vehicle">
        
        <!-- SECTION 1: Vehicle Identification -->
        <h3 style="color: var(--primary); border-bottom: 2px solid var(--primary); padding-bottom: 10px;">
          <i class="ri-car-line"></i> Vehicle Identification
        </h3>
        
        <div class="form-group">
          <label class="form-label">VIN (Vehicle Identification Number) *</label>
          <input type="text" name="vin" class="form-control" maxlength="17" pattern="[A-HJ-NPR-Z0-9]{17}" required style="text-transform: uppercase;">
          <small style="color: var(--text-light);">17 characters, no I, O, or Q</small>
        </div>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
          <div class="form-group">
            <label class="form-label">Plate Number *</label>
            <input type="text" name="plateNumber" class="form-control" required style="text-transform: uppercase;" placeholder="e.g., ABC123GP">
          </div>
          
          <div class="form-group">
            <label class="form-label">Engine Number *</label>
            <input type="text" name="engineNumber" class="form-control" required style="text-transform: uppercase;">
          </div>
        </div>
        
        <!-- SECTION 2: Basic Vehicle Information -->
        <h3 style="margin-top: 40px; color: var(--primary); border-bottom: 2px solid var(--primary); padding-bottom: 10px;">
          <i class="ri-information-line"></i> Basic Information
        </h3>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
          <div class="form-group">
            <label class="form-label">Make *</label>
            <input type="text" name="make" class="form-control" required placeholder="e.g., BMW, Toyota, Ford">
          </div>
          
          <div class="form-group">
            <label class="form-label">Model *</label>
            <input type="text" name="model" class="form-control" required placeholder="e.g., 3 Series, Corolla, F-150">
          </div>
        </div>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px;">
          <div class="form-group">
            <label class="form-label">Year *</label>
            <select name="year" class="form-control" required>
              <option value="">Select Year</option>
              <% for(let year = 2025; year >= 1980; year--) { %>
                <option value="<%= year %>"><%= year %></option>
              <% } %>
            </select>
          </div>
          
          <div class="form-group">
            <label class="form-label">Mileage (km) *</label>
            <input type="number" name="mileage" class="form-control" min="0" required placeholder="0">
          </div>
          
          <div class="form-group">
            <label class="form-label">Price (ZAR) *</label>
            <input type="number" name="price" class="form-control" min="0" step="1" required placeholder="0">
          </div>
        </div>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px;">
          <div class="form-group">
            <label class="form-label">Color</label>
            <input type="text" name="color" class="form-control" placeholder="e.g., Black, White, Silver">
          </div>
          
          <div class="form-group">
            <label class="form-label">Body Type *</label>
            <select name="bodyType" class="form-control" required>
              <option value="">Select...</option>
              <option value="Sedan">Sedan</option>
              <option value="SUV">SUV</option>
              <option value="Truck">Truck</option>
              <option value="Coupe">Coupe</option>
              <option value="Convertible">Convertible</option>
              <option value="Hatchback">Hatchback</option>
              <option value="Van">Van</option>
              <option value="Wagon">Wagon</option>
            </select>
          </div>
          
          <div class="form-group">
            <label class="form-label">Transmission *</label>
            <select name="transmission" class="form-control" required>
              <option value="">Select...</option>
              <option value="Automatic">Automatic</option>
              <option value="Manual">Manual</option>
              <option value="Semi-Automatic">Semi-Automatic</option>
            </select>
          </div>
        </div>
        
        <!-- SECTION 3: Registration & Legal Information -->
        <h3 style="margin-top: 40px; color: var(--primary); border-bottom: 2px solid var(--primary); padding-bottom: 10px;">
          <i class="ri-file-list-3-line"></i> Registration & Legal Information
        </h3>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
          <div class="form-group">
            <label class="form-label">Registration Authority *</label>
            <select name="registrationAuthority" class="form-control" required>
              <option value="">Select Province...</option>
              <option value="Gauteng">Gauteng (GP)</option>
              <option value="Western Cape">Western Cape (WC)</option>
              <option value="KwaZulu-Natal">KwaZulu-Natal (KZN)</option>
              <option value="Eastern Cape">Eastern Cape (EC)</option>
              <option value="Free State">Free State (FS)</option>
              <option value="Mpumalanga">Mpumalanga (MP)</option>
              <option value="Limpopo">Limpopo (L)</option>
              <option value="North West">North West (NW)</option>
              <option value="Northern Cape">Northern Cape (NC)</option>
            </select>
          </div>
          
          <div class="form-group">
            <label class="form-label">Vehicle Status *</label>
            <select name="vehicleStatus" class="form-control" required>
              <option value="">Select...</option>
              <option value="used">Used</option>
              <option value="new">New</option>
            </select>
          </div>
        </div>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px;">
          <div class="form-group">
            <label class="form-label">Tare Weight (kg)</label>
            <input type="number" name="tareWeight" class="form-control" min="0" placeholder="e.g., 1500">
            <small style="color: var(--text-light);">Vehicle weight without load</small>
          </div>
          
          <div class="form-group">
            <label class="form-label">Date Liable for Licensing</label>
            <input type="date" name="dateLiabilityLicensing" class="form-control">
          </div>
          
          <div class="form-group">
            <label class="form-label">Date Liable for Registration</label>
            <input type="date" name="dateLiableRegistration" class="form-control">
          </div>
        </div>
        
        <div class="form-group">
          <label class="form-label">Last 3 License Numbers (Most Recent First)</label>
          <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px;">
            <input type="text" name="licenseNumber1" class="form-control" placeholder="Most recent" style="text-transform: uppercase;">
            <input type="text" name="licenseNumber2" class="form-control" placeholder="Second most recent" style="text-transform: uppercase;">
            <input type="text" name="licenseNumber3" class="form-control" placeholder="Third most recent" style="text-transform: uppercase;">
          </div>
          <small style="color: var(--text-light);">Leave empty if not available</small>
        </div>
        
        <!-- SECTION 4: Engine & Fuel Information -->
        <h3 style="margin-top: 40px; color: var(--primary); border-bottom: 2px solid var(--primary); padding-bottom: 10px;">
          <i class="ri-settings-3-line"></i> Engine & Fuel Information
        </h3>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px;">
          <div class="form-group">
            <label class="form-label">Fuel Type *</label>
            <select name="fuelType" class="form-control" required>
              <option value="">Select...</option>
              <option value="Petrol">Petrol</option>
              <option value="Diesel">Diesel</option>
              <option value="Electric">Electric</option>
              <option value="Hybrid">Hybrid (Petrol/Electric)</option>
              <option value="Plug-in Hybrid">Plug-in Hybrid</option>
              <option value="CNG">CNG (Compressed Natural Gas)</option>
              <option value="LPG">LPG (Liquefied Petroleum Gas)</option>
            </select>
          </div>
          
          <div class="form-group">
            <label class="form-label">Engine Type *</label>
            <select name="engineType" class="form-control" required>
              <option value="">Select...</option>
              <option value="Inline-4">Inline-4</option>
              <option value="Inline-6">Inline-6</option>
              <option value="V6">V6</option>
              <option value="V8">V8</option>
              <option value="V12">V12</option>
              <option value="Boxer">Boxer/Flat</option>
              <option value="Rotary">Rotary</option>
              <option value="Electric Motor">Electric Motor</option>
              <option value="Hybrid">Hybrid</option>
            </select>
          </div>
          
          <div class="form-group">
            <label class="form-label">Engine Capacity</label>
            <input type="text" name="engineCapacity" class="form-control" placeholder="e.g., 2.0L, 3.5L, 250kW">
            <small style="color: var(--text-light);">Liters (L) or kW for electric</small>
          </div>
        </div>
        
        <!-- SECTION 5: Ownership -->
        <h3 style="margin-top: 40px; color: var(--primary); border-bottom: 2px solid var(--primary); padding-bottom: 10px;">
          <i class="ri-user-3-line"></i> Ownership Information
        </h3>
        
        <div class="form-group">
          <label class="form-label">Number of Previous Owners *</label>
          <input type="number" name="previousOwners" class="form-control" min="0" max="20" value="0" required>
          <small style="color: var(--text-light);">Enter 0 if first owner/new vehicle</small>
        </div>
        
        <!-- SECTION 6: Vehicle History -->
        <h3 style="margin-top: 40px; color: var(--primary); border-bottom: 2px solid var(--primary); padding-bottom: 10px;">
          <i class="ri-file-history-line"></i> Vehicle History
        </h3>
        
        <div class="form-group">
          <label class="form-label">Service History *</label>
          <textarea name="serviceHistory" class="form-control" rows="5" required placeholder="Detail all service records with dates and mileage..."></textarea>
          <small style="color: var(--text-light);">Example: "15,000 km service on 2023-05-15 at authorized dealer. Oil change, filter replacement. 30,000 km service on 2024-01-20..."</small>
        </div>
        
        <div class="form-group">
          <label class="form-label">Accident History *</label>
          <textarea name="accidentHistory" class="form-control" rows="3" required placeholder="No accidents OR detail any accidents with dates and repairs..."></textarea>
          <small style="color: var(--text-light);">Be honest - this builds trust. Include dates, damage details, and repair documentation.</small>
        </div>
        
        <div class="form-group">
          <label class="form-label">Recall Information *</label>
          <textarea name="recallInformation" class="form-control" rows="2" required placeholder="No open recalls OR list completed recalls..."></textarea>
          <small style="color: var(--text-light);">Check manufacturer website for recall history by VIN.</small>
        </div>
        
        <div class="form-group">
          <label class="form-label">Additional Features</label>
          <textarea name="additionalFeatures" class="form-control" rows="4" placeholder="List additional features (e.g., Leather seats, Navigation system, Sunroof, Parking sensors, Bluetooth, Cruise control, etc.)"></textarea>
        </div>
        
        <div class="form-group">
          <label class="form-label">Vehicle Description</label>
          <textarea name="description" class="form-control" rows="4" placeholder="Provide a detailed description of the vehicle condition and any notable features..."></textarea>
        </div>
        
        <div style="margin-top: 40px; border-top: 2px solid var(--border); padding-top: 20px; background: #f0f9ff; padding: 20px; border-radius: 8px;">
          <p style="margin-bottom: 15px; color: var(--text); font-weight: 500;">
            <i class="ri-information-line" style="color: var(--primary);"></i> 
            By submitting this vehicle, you confirm that all information provided is accurate and complete.
          </p>
          <button type="submit" class="btn btn-primary" style="font-size: 1.1rem; padding: 15px 40px;">
            <i class="ri-qr-code-line"></i> Add Vehicle & Generate QR Code
          </button>
          <a href="/dealership/vehicles" class="btn btn-secondary" style="margin-left: 15px;">Cancel</a>
        </div>
      </form>
    </div>
  </div>
  
  <%- include('../partials/footer') %>
  
  <script>
    // Auto-uppercase for specific fields
    const uppercaseFields = ['vin', 'plateNumber', 'engineNumber', 'licenseNumber1', 'licenseNumber2', 'licenseNumber3'];
    uppercaseFields.forEach(fieldName => {
      const field = document.querySelector(`input[name="${fieldName}"]`);
      if (field) {
        field.addEventListener('input', function(e) {
          this.value = this.value.toUpperCase();
        });
      }
    });
    
    // Form validation feedback
    document.querySelector('form').addEventListener('submit', function(e) {
      const vin = document.querySelector('input[name="vin"]').value;
      if (!/^[A-HJ-NPR-Z0-9]{17}$/.test(vin)) {
        e.preventDefault();
        alert('Invalid VIN format. Must be exactly 17 characters with no I, O, or Q.');
        return false;
      }
    });
  </script>
</body>
</html>
